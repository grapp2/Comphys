/*
Greg Rapp
9/23/2020
ex4-9
*/
#include <stdio.h>

double linearInterp(double tab[27][23],double x1,double x2);
const int a = 27;
const int b = 23;
double table[27][23] = {{0,          0,     25,     50,     75,    100,    150,    200,    250,    300,    350,    375,    400,    425,    450,    475,    500,    550,    600,    650,    700,    750,    800},\
                {1,         1792,  890.8,  547.1,  378.4,  12.28,  14.19,  16.18,  18.22,  20.29,  22.37,  23.41,  24.45,  25.49,  26.52,  27.55,  28.57,  30.61,  32.61,  34.60,  36.55,  38.48,  40.38},\
                {5,         1791,  890.7,  547.1,  378.5,  282.4,  182.0,  16.07,  18.15,  20.25,  22.35,  23.39,  24.44,  25.48,  26.52,  27.55,  28.58,  30.62,  32.63,  34.61,  36.57,  38.50,  40.39},\
                {10,        1790,  890.6,  547.2,  378.6,  282.6,  182.1,  15.93,  18.07,  20.20,  22.32,  23.37,  24.42,  25.47,  26.52,  27.55,  28.58,  30.63,  32.64,  34.63,  36.59,  38.52,  40.42},\
                {25,        1786,  890.3,  547.5,  379.0,  283.0,  182.5,  133.9,  17.83,  20.06,  22.24,  23.32,  24.39,  25.46,  26.52,  27.57,  28.61,  30.67,  32.70,  34.70,  36.66,  38.59,  40.50},\
                {50,        1780,  889.9,  547.9,  379.6,  283.6,  183.2,  134.5,  106.1,  19.86,  22.15,  23.27,  24.38,  25.47,  26.55,  27.62,  28.67,  30.76,  32.81,  34.82,  36.79, 38.73,  40.63},\
                {75,        1775,  889.3,  548.3,  380.2,  284.3,  183.8,  135.1,  106.8,  19.74,  22.13,  23.28,  24.40,  25.52,  26.61,  27.70,  28.77,  30.87,  32.93,  34.95,  36.93,  38.88,  40.78},\
                {100,       1769,  888.9,  548.7,  380.9,  284.9,  184.4,  135.7,  107.5,  86.42,  22.18,  23.35,  24.49,  25.62,  26.72,  27.82,  28.89,  31.01,  33.09,  35.11,  37.09,  39.04,  40.94},\
                {125,       1764,  888.5,  549.1,  381.5,  285.6,  185.1,  136.3,  108.2,  87.40,  22.39,  23.52,  24.65,  25.77,  26.88,  27.98,  29.06,  31.18,  33.26,  35.28,  37.27,  39.21,  41.11},\
                {150,       1759,  888.1,  549.5,  382.1,  286.3,  185.7,  136.9,  108.8,  88.32,  22.91,  23.84,  24.91,  26.01,  27.10,  28.19,  29.27,  31.38,  33.45,  35.48,  37.46,  39.39,  41.29},\
                {175,       1754,  887.7,  550.0,  382.7,  286.9,  186.3,  137.5,  109.5,  89.21,  66.85,  24.45,  25.32,  26.34,  27.39,  28.46,  29.52,  31.62,  33.68,  35.69,  37.66,  39.59,  41.48},\
                {200,       1749,  887.4,  550.4,  383.4,  287.6,  186.9,  138.1,  110.1,  90.06,  69.21,  25.79,  25.96,  26.80,  27.77,  28.79,  29.82,  31.89,  33.92,  35.93,  37.88,  39.80,  41.68},\
                {225,       1744,  887.1,  550.9,  384.0,  288.2,  187.6,  138.7,  110.7,  90.88,  71.10,  47.65,  27.03,  27.44,  28.26,  29.20,  30.18,  32.19,  34.20,  36.18,  38.12,  40.03,  41.89},\
                {250,       1739,  886.8,  551.3,  384.6,  288.9,  188.2,  139.3,  111.4,  91.67,  72.71,  58.09,  29.00,  28.36,  28.89,  29.70,  30.61,  32.54,  34.50,  36.45,  38.38,  40.26,  42.11},\
                {275,       1735,  886.6,  551.8,  385.2,  289.5,  188.8,  139.9,  112.0,  92.43,  74.14,  61.87,  33.73,  29.70,  29.71,  30.32,  31.12,  32.93,  34.84,  36.75,  38.64,  40.51,  42.35},\
                {300,       1731,  886.4,  552.3,  385.9,  290.2,  189.4,  140.5,  112.6,  93.18,  75.43,  64.49,  43.83,  31.73,  30.78,  31.06,  31.71,  33.37,  35.20,  37.07,  38.93,  40.77,  42.59},\
                {350,       1722,  886.0,  553.3,  387.2,  291.5,  190.6,  141.6,  113.8,  94.61,  77.71,  68.31,  55.78,  39.35,  33.97,  33.06,  33.19,  34.40,  36.02,  37.77,  39.55,  41.33,  43.10},\
                {400,       1714,  885.8,  554.3,  388.4,  292.8,  191.8,  142.8,  114.9,  95.98,  79.72,  71.21,  61.29,  48.69,  39.05,  35.92,  35.16,  35.65,  36.98,  38.56,  40.24,  41.94,  43.65},\
                {450,       1707,  885.6,  555.3,  389.7,  294.2,  193.1,  143.9,  116.1,  97.28,  81.52,  73.61,  65.01,  55.07,  45.22,  39.72,  37.68,  37.15,  38.07,  39.44,  40.98,  42.60,  44.24},\
                {500,       1700,  885.5,  556.4,  391.0,  295.5,  194.3,  145.0,  117.2,  98.55,  83.19,  75.70,  67.89,  59.44,  50.71,  44.08,  40.70,  38.88,  39.30,  40.41,  41.79,  43.30,  44.85},\
                {550,       1694,  885.6,  557.5,  392.3,  296.8,  195.5,  146.1,  118.3,  99.76,  84.73,  77.57,  70.30,  62.76,  55.06,  48.36,  44.02,  40.84,  40.65,  41.45,  42.65,  44.03,  45.50},\
                {600,       1687,  885.7,  558.6,  393.6,  298.1,  196.7,  147.2,  119.4,  100.9,  86.19,  79.27,  72.40,  65.46,  58.52,  52.16,  47.37,  42.96,  42.12,  42.57,  43.57,  44.81,  46.17},\
                {650,       1682,  885.9,  559.7,  395.0,  299.4,  197.9,  148.3,  120.4,  102.1,  87.57,  80.85,  74.28,  67.76,  61.36,  55.40,  50.53,  45.18,  43.67,  43.75,  44.52,  45.61,  46.87},\
                {700,       1676,  886.2,  560.9,  396.3,  300.8,  199.0,  149.3,  121.5,  103.2,  88.88,  82.33,  75.98,  69.79,  63.79,  58.18,  53.38,  47.41,  45.28,  44.98,  45.51,  46.44,  47.58},\
                {800,       1667,  887.1,  563.3,  399.0,  303.4,  201.4,  151.5,  123.5,  105.4,  91.35,  85.05,  79.04,  73.28,  67.81,  62.72,  58.20,  51.70,  48.55,  47.52,  47.55,  48.15,  49.04},\
               	{900,       1659,  888.3,  565.8,  401.7,  306.1,  203.8,  153.6,  125.5,  107.4,  93.65,  87.54,  81.75,  76.27,  71.11,  66.35,  62.09,  55.51,  51.73,  50.06,  49.62,  49.88,  50.52},\
  		{1000,       1653,  889.9,  568.4,  404.4,  308.7,  206.1,  155.6,  127.5,  109.4,  95.82,  89.84,  84.22,  78.92,  73.97,  69.42,  65.32,  58.80,  54.66,  52.50,  51.65,  51.58,  51.98}};

int main(){
  double p,t,y;
  printf("Enter pressure and temperature separated by a comma: ");
  scanf("%lf,%lf",&p,&t);
  y = linearInterp(table,p,t);
  printf("Calculated viscosity of water: %lf\n",y);
  return 0;
}

double linearInterp(double tab[27][23],double x1,double x2){
  int j,k;
  double y1,y2,y3,y4,t,u,y;
  for (int i = 0; i < a; i++){
    if (tab[i][0] < x2 && tab[i+1][0] >= x2){
      j = i;
      break;
    }
  }
  for(int i = 0; i< b; i++){
    if (tab[0][i] < x1 && tab[0][i+1] > x1){
      k = i;
      break;
    }
  }
  y1 = tab[j][k];
  y2 = tab[j][k+1];
  y3 = tab[j+1][k+1];
  y4 = tab[j+1][k];
  t = (x1 - tab[0][k])/(tab[0][k+1]-tab[0][k]);
  u = (x2 - tab[j][0])/(tab[j+1][0]-tab[j][0]);
  y = (1-t)*(1-u)*y1+t*(1-u)*y2+t*u*y3+(1-t)*u*y4;

  return y;
}

